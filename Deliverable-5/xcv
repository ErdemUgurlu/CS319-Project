Final code is in the branch final-dev
